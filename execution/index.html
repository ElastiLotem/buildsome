<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Buildsome devs">
  
  <title>Execution - Buildsome</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Execution";
    var mkdocs_page_input_path = "execution.md";
    var mkdocs_page_url = "/execution/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Buildsome</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../ChangeLog/">Changelog</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Documentation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../install/">Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../syntax/">Buildsome.mk syntax</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Execution</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#execution">Execution</a></li>
                
                    <li><a class="toctree-l4" href="#specifying-targets">Specifying targets</a></li>
                
                    <li><a class="toctree-l4" href="#output-format">Output format</a></li>
                
                    <li><a class="toctree-l4" href="#execution-warnings">Execution warnings</a></li>
                
                    <li><a class="toctree-l4" href="#execution-errors">Execution errors</a></li>
                
                    <li><a class="toctree-l4" href="#parallelism">Parallelism</a></li>
                
                    <li><a class="toctree-l4" href="#bypassing-automatic-dependency-detection">Bypassing automatic dependency detection</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../issues/">Reporting issues</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../credits/">Credits</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Buildsome</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Execution</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/buildsome/buildsome/tree/master/doc" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="execution">Execution<a class="headerlink" href="#execution" title="Permanent link">&para;</a></h1>
<p>To see an overview of all command line options, run <code>buildsome --help</code>. This
document will focus on most significant aspects of the command line options,
and operation around building.</p>
<h2 id="specifying-targets">Specifying targets<a class="headerlink" href="#specifying-targets" title="Permanent link">&para;</a></h2>
<p>One or more target can specified at the command line, or none at all (explained
here);</p>
<pre><code class="no-highlight">buildsome
</code></pre>

<p>Or:</p>
<pre><code class="no-highlight">buildsome some-file-to-build subdir/some/nested/target
</code></pre>

<p>Or from inside a subdirectory:</p>
<pre><code class="no-highlight">cd subdir/some
buildsome nested/target
</code></pre>

<p>By default, <code>Buildsome</code> regards the directory containing the top-most
<code>Buildsome.mk</code> as the root dir, and always starts evaluating the
target tree from there. Additionally, running <code>buildsome</code> without specifying
targets, while in any sub-directory, is equivalent to trying to build
the <code>default</code> target in that sub-directory.</p>
<h3 id="building-in-sub-directory-while-being-in-it-or-outside-of-it">Building in sub-directory while being in it, or outside of it<a class="headerlink" href="#building-in-sub-directory-while-being-in-it-or-outside-of-it" title="Permanent link">&para;</a></h3>
<p>It may be confusing that passing a source directory to <code>buildsome</code> as
a target does nothing. That happens because the directory itself
already exists, so nothing needs to be done. Instead, if one defines a
<code>default</code> target in a subdirectory, it would make more sense to pass
that target explicity, e.g. <code>buildsome subdir/default</code>.</p>
<h2 id="output-format">Output format<a class="headerlink" href="#output-format" title="Permanent link">&para;</a></h2>
<p>Buildsome makes an effort to tell why a target is being built. There
could be various reasons:</p>
<ul>
<li>Rebuild due to changes in the content or meta-data of an input.</li>
</ul>
<pre><code class="no-highlight">T141 Execution log of [&quot;src/.objs/Class.c.release.o&quot;] did not match because input(content): change: &quot;src/Class.c&quot;
T141 { [&quot;src/Class.o&quot;] BUILDING (BecauseSpeculative (BecauseHooked AccessDocEmpty))
</code></pre>

<ul>
<li>Output is missing</li>
</ul>
<pre><code class="no-highlight">T093 Execution log of [&quot;src/Class.o&quot;] did not match because output file was deleted: &quot;src/Class.o&quot;
T093 { [&quot;src/Class.o&quot;] BUILDING (BecauseSpeculative (BecauseHooked AccessDocEmpty))
</code></pre>

<ul>
<li>Rebuild due to changes in the evaulated target script.</li>
</ul>
<pre><code class="no-highlight">T093 { [&quot;src/Class.o&quot;] BUILDING (BecauseSpeculative (BecauseHooked AccessDocEmpty))
</code></pre>

<p><strong>(TODO: it does not explicitly say that a target script was changed.
This needs fixing)</strong>.</p>
<h2 id="execution-warnings">Execution warnings<a class="headerlink" href="#execution-warnings" title="Permanent link">&para;</a></h2>
<h3 id="over-specified-inputs">Over-specified inputs<a class="headerlink" href="#over-specified-inputs" title="Permanent link">&para;</a></h3>
<p>If a target depends on a file explicitly in the definition, but does not
make use of that file as an input during execution, this warning is
emitted. It is important for targets to confirm to their minimal
specification</p>
<h2 id="execution-errors">Execution errors<a class="headerlink" href="#execution-errors" title="Permanent link">&para;</a></h2>
<p>Various errors are encountered by users of Buildsome. The following is
a summary of the major ones, and detailed explaination.</p>
<h3 id="thirdpartymeddlingerror">ThirdPartyMeddlingError<a class="headerlink" href="#thirdpartymeddlingerror" title="Permanent link">&para;</a></h3>
<p>Prior to letting target running under Buildsome to open their dependencies,
Buildsome checks the modification time of the input files at the leaf of
the dependencies tree. If any of these sources files change during the,
this error is emitted.</p>
<p>This feature is meant to detected accidental user edits during execution.
Without this build, in a compilation which consists of several files may
result in an invalid build, because some of the targets received inputs
that don't match the inputs of other targets. This is especially valid
for C headers, for example.</p>
<h3 id="targetcommandfailed">TargetCommandFailed<a class="headerlink" href="#targetcommandfailed" title="Permanent link">&para;</a></h3>
<p>This error indicates that one of the target scripts returned a non-zero
status code and likely failed. For example, this is the UNIX behavior
to signify process execution failure.</p>
<h3 id="unregisteredoutputfileexists">UnregisteredOutputFileExists<a class="headerlink" href="#unregisteredoutputfileexists" title="Permanent link">&para;</a></h3>
<p>Because Buildsome tracks the output files of all targets (removing
the necessity of manually maintaing a old fashioned 'clean' target),
then it mindful about finding files that were not created by any
target in a previous invocation.</p>
<p>This could happen if Buildsome is executed and for some reason later,
the database that it maintains to track executions gets deleted. The
database is <code>Buildsome.mk.db</code>, and it resides at the top directory,
where <code>Buildsome.mk</code> is located. It is possible to provide the
<code>--overwrite</code> switch in that case, to suppress this behavior. It
should not be the default way of executing Buildsome, in any case.</p>
<h3 id="targetdependencyloop">TargetDependencyLoop<a class="headerlink" href="#targetdependencyloop" title="Permanent link">&para;</a></h3>
<p>When Buildsome detects that a target directly or indirectly depends on
itself, whether implicitly or explicitly, this error is emitted. Note
that directory listing by processes introduces a dependency over the
directory that is being listed. If the same process also modifies that
directory, it would constitued a dependency loop.</p>
<h2 id="parallelism">Parallelism<a class="headerlink" href="#parallelism" title="Permanent link">&para;</a></h2>
<p>It is possible to pass a <code>-j</code> parameter that determines the number of
jobs to run in parallel. Note that it does not serve as a hard limit,
because it is possible that jobs would be temporarily stopped
mid-execution in order to satisfy dependencies, so <code>-j</code> comes to serve
as a limit to the number of jobs currently not waiting for any
dependency.</p>
<h2 id="bypassing-automatic-dependency-detection">Bypassing automatic dependency detection<a class="headerlink" href="#bypassing-automatic-dependency-detection" title="Permanent link">&para;</a></h2>
<p>Under Buildsome, certain types of targets are problematic. For example,
targets that maintain their own caching, meaning they arbitrarily read
inputs from a previous invocation. You may find the complex 'do-all'
tools such as <code>go build</code> (of the Go language), <code>mvn</code> (Maven), or <code>ccache</code>
may behave in such a way.</p>
<p>It is possible to suppress the dependency scanning of Buildsome by
overriding the <code>LD_PRELOAD</code> variable during target execution.</p>
<p><strong>NOTE: One must be careful when doing so, because it means that inputs
would not be detected, and later, unbeknownst to the developer, actual
dependencies would not match the specification that Buildsome infers,
regressing back to gmake-like hell.</strong></p>
<h3 id="example-pattern-for-dependency-detection-bypass">Example pattern for dependency detection bypass<a class="headerlink" href="#example-pattern-for-dependency-detection-bypass" title="Permanent link">&para;</a></h3>
<p>Suppose we have a program named <code>problematic-command</code> which performs
problematic file system accesses during its execution. Suppose that
we know for a fact that it only reads to inputs <code>input-a</code> and <code>input-b</code>.</p>
<p>In that case, we can use shell script to let it execute under Buildsome,
but still hint Buildsome regarding the outputs and inputs of the whole
target, using file accesses of our own. Our shell script can appear as
such:</p>
<pre><code class="no-highlight">#!/bin/bash

cat input-a input-b &gt; /dev/null
LD_PRELOAD= problematic-command output-tmp
cat output-tmp &gt; actual-output
</code></pre>

<p>And in the <code>.mk</code> file:</p>
<pre><code class="no-highlight">actual-output:
        script.sh
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../issues/" class="btn btn-neutral float-right" title="Reporting issues">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../syntax/" class="btn btn-neutral" title="Buildsome.mk syntax"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright (c) 2015-2016, Buildsome devs</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/buildsome/buildsome/tree/master/doc" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../syntax/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../issues/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
